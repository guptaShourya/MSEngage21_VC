{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _toConsumableArray from \"/Users/shouryagupta/Desktop/MS Engage 21/MSEngage21_VC/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/Users/shouryagupta/Desktop/MS Engage 21/MSEngage21_VC/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/shouryagupta/Desktop/MS Engage 21/MSEngage21_VC/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/shouryagupta/Desktop/MS Engage 21/MSEngage21_VC/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/shouryagupta/Desktop/MS Engage 21/MSEngage21_VC/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/Users/shouryagupta/Desktop/MS Engage 21/MSEngage21_VC/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/shouryagupta/Desktop/MS Engage 21/MSEngage21_VC/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/Users/shouryagupta/Desktop/MS Engage 21/MSEngage21_VC/src/ChatUtils.js\";\nimport React from \"react\";\nimport { AppBar, Backdrop, CircularProgress, Container, CssBaseline, Grid, IconButton, List, TextField, Toolbar, Typography, Button, Tooltip } from \"@material-ui/core\";\nimport { ListItem } from \"@material-ui/core\";\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport VideoCallOutlinedIcon from '@material-ui/icons/VideoCallOutlined';\nimport ExitToAppOutlinedIcon from '@material-ui/icons/ExitToAppOutlined';\nimport GroupAddOutlinedIcon from '@material-ui/icons/GroupAddOutlined';\nimport { Send } from \"@material-ui/icons\";\nimport ChatItem from \"./ChatItem\";\nimport VideoChat_test from \"./VideoChat_test\";\n\nvar Chat = require(\"twilio-chat\");\n\nvar ChatScreen = /*#__PURE__*/function (_React$Component) {\n  _inherits(ChatScreen, _React$Component);\n\n  var _super = _createSuper(ChatScreen);\n\n  function ChatScreen(props) {\n    var _this;\n\n    _classCallCheck(this, ChatScreen);\n\n    _this = _super.call(this, props);\n\n    _this.getToken = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(email) {\n        var data;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch(\"/chat/token\", {\n                  method: \"POST\",\n                  body: JSON.stringify({\n                    identity: email\n                  }),\n                  headers: {\n                    \"Content-Type\": \"application/json\"\n                  }\n                }).then(function (res) {\n                  return res.json();\n                });\n\n              case 2:\n                data = _context.sent;\n                return _context.abrupt(\"return\", data.token);\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.componentDidMount = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var _this$state, email, room, token, client, channel;\n\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              document.getElementsByTagName('body')[0].style.background = \"rgb(255,255,255)\";\n              _this$state = _this.state, email = _this$state.email, room = _this$state.room;\n              token = \"\";\n\n              _this.setState({\n                loading: true\n              });\n\n              _context4.prev = 4;\n              _context4.next = 7;\n              return _this.getToken(email);\n\n            case 7:\n              token = _context4.sent;\n              _context4.next = 13;\n              break;\n\n            case 10:\n              _context4.prev = 10;\n              _context4.t0 = _context4[\"catch\"](4);\n              throw new Error(\"unable to get token, please reload thissss page\");\n\n            case 13:\n              _context4.next = 15;\n              return Chat.Client.create(token);\n\n            case 15:\n              client = _context4.sent;\n\n              _this.setState({\n                client: client\n              });\n\n              client.on(\"tokenAboutToExpire\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n                var token;\n                return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                  while (1) {\n                    switch (_context2.prev = _context2.next) {\n                      case 0:\n                        _context2.next = 2;\n                        return _this.getToken(email);\n\n                      case 2:\n                        token = _context2.sent;\n                        client.updateToken(token);\n\n                      case 4:\n                      case \"end\":\n                        return _context2.stop();\n                    }\n                  }\n                }, _callee2);\n              })));\n              client.on(\"tokenExpired\", /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n                var token;\n                return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                  while (1) {\n                    switch (_context3.prev = _context3.next) {\n                      case 0:\n                        _context3.next = 2;\n                        return _this.getToken(email);\n\n                      case 2:\n                        token = _context3.sent;\n                        client.updateToken(token);\n\n                      case 4:\n                      case \"end\":\n                        return _context3.stop();\n                    }\n                  }\n                }, _callee3);\n              }))); // client.on(\"channelJoined\", async (channel) => {\n              //   // getting list of all messages since this is an existing channel\n              //   const messages = await channel.getMessages();\n              //   this.setState({ messages: messages.items || [] });\n              //   //   this.scrollToBottom();\n              // });\n\n              _context4.prev = 19;\n\n              _this.joine(room);\n\n              _context4.next = 37;\n              break;\n\n            case 23:\n              _context4.prev = 23;\n              _context4.t1 = _context4[\"catch\"](19);\n              _context4.prev = 25;\n              _context4.next = 28;\n              return client.createChannel({\n                uniqueName: room,\n                friendlyName: room\n              });\n\n            case 28:\n              channel = _context4.sent;\n              _context4.next = 31;\n              return _this.joinChannel(channel);\n\n            case 31:\n              _this.setState({\n                channel: channel,\n                loading: false\n              });\n\n              _context4.next = 37;\n              break;\n\n            case 34:\n              _context4.prev = 34;\n              _context4.t2 = _context4[\"catch\"](25);\n              throw new Error(\"unable to create channel, please reload this page\");\n\n            case 37:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[4, 10], [19, 23], [25, 34]]);\n    }));\n\n    _this.joine = /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(room) {\n        var client, channel, messages, channels;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                client = _this.state.client;\n                console.log(room);\n                _context5.next = 4;\n                return client.getChannelByUniqueName(room);\n\n              case 4:\n                channel = _context5.sent;\n                _context5.next = 7;\n                return _this.joinChannel(channel);\n\n              case 7:\n                _this.setState({\n                  channel: channel,\n                  loading: false\n                });\n\n                _context5.next = 10;\n                return channel.getMessages();\n\n              case 10:\n                messages = _context5.sent;\n\n                _this.setState({\n                  messages: messages.items || []\n                });\n\n                _context5.next = 14;\n                return client.getSubscribedChannels();\n\n              case 14:\n                channels = _context5.sent;\n\n                _this.setState({\n                  channelList: channels.items || []\n                });\n\n              case 16:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      return function (_x2) {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n\n    _this.joinChannel = /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(channel) {\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                if (!(channel.channelState.status !== \"joined\")) {\n                  _context6.next = 3;\n                  break;\n                }\n\n                _context6.next = 3;\n                return channel.join();\n\n              case 3:\n                channel.on(\"messageAdded\", _this.handleMessageAdded);\n\n              case 4:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6);\n      }));\n\n      return function (_x3) {\n        return _ref6.apply(this, arguments);\n      };\n    }();\n\n    _this.handleMessageAdded = function (message) {\n      var messages = _this.state.messages;\n\n      _this.setState({\n        messages: !!messages ? [].concat(_toConsumableArray(messages), [message]) : [message]\n      } //   this.scrollToBottom\n      );\n    };\n\n    _this.sendMessage = function () {\n      var _this$state2 = _this.state,\n          text = _this$state2.text,\n          channel = _this$state2.channel;\n\n      if (text && String(text).trim()) {\n        _this.setState({\n          loading: true\n        });\n\n        channel && channel.sendMessage(text);\n\n        _this.setState({\n          text: \"\",\n          loading: false\n        });\n      }\n    };\n\n    _this.sendMessageExternal = function (info) {\n      var channel = _this.state.channel;\n\n      if (info && String(info).trim()) {\n        _this.setState({\n          loading: true\n        });\n\n        channel && channel.sendMessage(info);\n\n        _this.setState({\n          loading: false\n        });\n      }\n    };\n\n    _this.setIsVideo = function (val) {\n      _this.setState({\n        isVideo: val\n      });\n    };\n\n    _this.handleClick = function () {\n      _this.setState({\n        isVideo: true\n      });\n    };\n\n    _this.switchChannel = function (roomName) {\n      _this.setState({\n        room: roomName\n      });\n\n      _this.joine(roomName);\n    };\n\n    _this.state = {\n      text: \"\",\n      messages: [],\n      loading: false,\n      channel: null,\n      isVideo: false,\n      channelList: [],\n      client: null,\n      email: _this.props.email,\n      room: _this.props.room\n    };\n    _this.scrollDiv = /*#__PURE__*/React.createRef();\n    return _this;\n  }\n\n  _createClass(ChatScreen, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state3 = this.state,\n          loading = _this$state3.loading,\n          text = _this$state3.text,\n          messages = _this$state3.messages,\n          channel = _this$state3.channel,\n          isVideo = _this$state3.isVideo,\n          channelList = _this$state3.channelList,\n          email = _this$state3.email,\n          room = _this$state3.room;\n      var setSubmit = this.props.setSubmit;\n      var channels = [];\n\n      var _loop = function _loop(i) {\n        channels.push( /*#__PURE__*/_jsxDEV(Button, {\n          style: {\n            display: \"block\"\n          },\n          onClick: function onClick() {\n            _this2.switchChannel(channelList[i].friendlyName);\n          },\n          children: /*#__PURE__*/_jsxDEV(ListItem, {\n            children: [/*#__PURE__*/_jsxDEV(ChevronRightIcon, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 11\n            }, _this2), channelList[i].friendlyName]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 9\n          }, _this2)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 21\n        }, _this2));\n      };\n\n      for (var i = 0; i < channelList.length; i++) {\n        _loop(i);\n      }\n\n      var component;\n\n      if (isVideo) {\n        component = /*#__PURE__*/_jsxDEV(VideoChat_test, {\n          username: email,\n          roomName: room,\n          messages: messages,\n          setIsVideo: this.setIsVideo,\n          sendMessage: this.sendMessageExternal\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 19\n        }, this);\n      } else {\n        component = /*#__PURE__*/_jsxDEV(Container, {\n          component: \"main\",\n          maxWidth: \"md\",\n          style: {\n            maxWidth: \"none\",\n            paddingLeft: \"0px\",\n            background: \"rgb(242, 243, 248)\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(Backdrop, {\n            open: loading,\n            style: {\n              zIndex: 99999\n            },\n            children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n              style: {\n                color: \"white\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 189,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(AppBar, {\n            elevation: 10,\n            children: /*#__PURE__*/_jsxDEV(Toolbar, {\n              style: {\n                justifyContent: 'space-between'\n              },\n              children: [/*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"h6\",\n                children: \"YOUR ROOMS\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 13\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                container: true,\n                direction: \"column\",\n                children: /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  children: /*#__PURE__*/_jsxDEV(Typography, {\n                    variant: \"h6\",\n                    children: \"ROOM\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 198,\n                    columnNumber: 17\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 197,\n                  columnNumber: 15\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 196,\n                columnNumber: 13\n              }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                container: true,\n                direction: \"row-reverse\",\n                style: {\n                  width: \"84%\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  children: /*#__PURE__*/_jsxDEV(Tooltip, {\n                    title: \"Leave\",\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      onClick: function onClick() {\n                        setSubmit();\n                      },\n                      children: /*#__PURE__*/_jsxDEV(ExitToAppOutlinedIcon, {\n                        style: {\n                          position: 'relative',\n                          fontSize: \"2.45rem\",\n                          color: \"white\",\n                          marginTop: '4px'\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 207,\n                        columnNumber: 21\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 206,\n                      columnNumber: 19\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 205,\n                    columnNumber: 17\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 204,\n                  columnNumber: 15\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  children: /*#__PURE__*/_jsxDEV(Tooltip, {\n                    title: \"Add others\",\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      children: /*#__PURE__*/_jsxDEV(GroupAddOutlinedIcon, {\n                        style: {\n                          position: 'relative',\n                          fontSize: \"xxx-large\",\n                          color: \"white\"\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 214,\n                        columnNumber: 21\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 213,\n                      columnNumber: 19\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 212,\n                    columnNumber: 17\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 211,\n                  columnNumber: 15\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  children: /*#__PURE__*/_jsxDEV(Tooltip, {\n                    title: \"Switch to Video call\",\n                    children: /*#__PURE__*/_jsxDEV(Button, {\n                      onClick: this.handleClick,\n                      children: /*#__PURE__*/_jsxDEV(VideoCallOutlinedIcon, {\n                        style: {\n                          position: 'relative',\n                          fontSize: \"xxx-large\",\n                          color: \"white\"\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 221,\n                        columnNumber: 21\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 220,\n                      columnNumber: 19\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 219,\n                    columnNumber: 17\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 218,\n                  columnNumber: 15\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 13\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            style: {\n              width: \"100%\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              style: {\n                width: \"18%\",\n                background: \"rgb(242, 243, 248)\",\n                marginRightght: \"15px\",\n                height: \"100vh\"\n              },\n              children: /*#__PURE__*/_jsxDEV(List, {\n                style: {\n                  paddingTop: \"100px\"\n                },\n                children: channels\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 231,\n                columnNumber: 13\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 11\n            }, this), /*#__PURE__*/_jsxDEV(Grid, {\n              item: true,\n              style: {\n                width: \"80%\",\n                paddingRight: \"15px\"\n              },\n              children: /*#__PURE__*/_jsxDEV(Grid, {\n                container: true,\n                direction: \"column\",\n                style: styles.mainGrid,\n                children: [/*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  style: styles.gridItemChatList,\n                  children: /*#__PURE__*/_jsxDEV(List, {\n                    dense: true,\n                    children: messages && messages.map(function (message) {\n                      return /*#__PURE__*/_jsxDEV(ChatItem, {\n                        message: message,\n                        email: email\n                      }, message.index, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 241,\n                        columnNumber: 19\n                      }, _this2);\n                    })\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 238,\n                    columnNumber: 13\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 237,\n                  columnNumber: 11\n                }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                  item: true,\n                  style: styles.gridItemMessage,\n                  children: /*#__PURE__*/_jsxDEV(Grid, {\n                    container: true,\n                    direction: \"row\",\n                    justify: \"center\",\n                    alignItems: \"center\",\n                    children: [/*#__PURE__*/_jsxDEV(Grid, {\n                      item: true,\n                      style: styles.textFieldContainer,\n                      children: /*#__PURE__*/_jsxDEV(TextField, {\n                        required: true,\n                        style: styles.textField,\n                        placeholder: \"Send a message to everyone\",\n                        variant: \"outlined\",\n                        multiline: true,\n                        rows: 2,\n                        value: text,\n                        disabled: !channel,\n                        onChange: function onChange(event) {\n                          return _this2.setState({\n                            text: event.target.value\n                          });\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 257,\n                        columnNumber: 17\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 256,\n                      columnNumber: 15\n                    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n                      item: true,\n                      children: /*#__PURE__*/_jsxDEV(IconButton, {\n                        style: styles.sendButton,\n                        onClick: this.sendMessage,\n                        disabled: !channel || !text,\n                        children: /*#__PURE__*/_jsxDEV(Send, {\n                          style: styles.sendIcon\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 277,\n                          columnNumber: 19\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 272,\n                        columnNumber: 17\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 271,\n                      columnNumber: 15\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 250,\n                    columnNumber: 13\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 249,\n                  columnNumber: 11\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 11\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 235,\n              columnNumber: 11\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 19\n        }, this);\n      }\n\n      return component;\n    }\n  }]);\n\n  return ChatScreen;\n}(React.Component);\n\nvar styles = {\n  textField: {\n    width: \"100%\",\n    borderWidth: 0,\n    borderColor: \"transparent\"\n  },\n  textFieldContainer: {\n    flex: 1,\n    marginRight: 12\n  },\n  gridItem: {\n    paddingTop: 12,\n    paddingBottom: 12\n  },\n  gridItemChatList: {\n    overflow: \"auto\",\n    height: \"70vh\"\n  },\n  gridItemMessage: {\n    marginTop: 12,\n    marginBottom: 12\n  },\n  sendButton: {\n    backgroundColor: \"#3f51b5\"\n  },\n  sendIcon: {\n    color: \"white\"\n  },\n  mainGrid: {\n    paddingTop: 100,\n    borderWidth: 1,\n    background: \"white\",\n    borderRadius: \"3px\",\n    paddingRight: \"10px\",\n    paddingLeft: \"10px\"\n  }\n};\nexport default ChatScreen;","map":{"version":3,"sources":["/Users/shouryagupta/Desktop/MS Engage 21/MSEngage21_VC/src/ChatUtils.js"],"names":["React","AppBar","Backdrop","CircularProgress","Container","CssBaseline","Grid","IconButton","List","TextField","Toolbar","Typography","Button","Tooltip","ListItem","ChevronRightIcon","VideoCallOutlinedIcon","ExitToAppOutlinedIcon","GroupAddOutlinedIcon","Send","ChatItem","VideoChat_test","Chat","require","ChatScreen","props","getToken","email","fetch","method","body","JSON","stringify","identity","headers","then","res","json","data","token","componentDidMount","document","getElementsByTagName","style","background","state","room","setState","loading","Error","Client","create","client","on","updateToken","joine","createChannel","uniqueName","friendlyName","channel","joinChannel","console","log","getChannelByUniqueName","getMessages","messages","items","getSubscribedChannels","channels","channelList","channelState","status","join","handleMessageAdded","message","sendMessage","text","String","trim","sendMessageExternal","info","setIsVideo","val","isVideo","handleClick","switchChannel","roomName","scrollDiv","createRef","setSubmit","i","push","display","length","component","maxWidth","paddingLeft","zIndex","color","justifyContent","width","position","fontSize","marginTop","marginRightght","height","paddingTop","paddingRight","styles","mainGrid","gridItemChatList","map","index","gridItemMessage","textFieldContainer","textField","event","target","value","sendButton","sendIcon","Component","borderWidth","borderColor","flex","marginRight","gridItem","paddingBottom","overflow","marginBottom","backgroundColor","borderRadius"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {\n  AppBar,\n  Backdrop,\n  CircularProgress,\n  Container,\n  CssBaseline,\n  Grid,\n  IconButton,\n  List,\n  TextField,\n  Toolbar,\n  Typography,\n  Button,\n  Tooltip,\n} from \"@material-ui/core\";\nimport { ListItem } from \"@material-ui/core\";\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport VideoCallOutlinedIcon from '@material-ui/icons/VideoCallOutlined';\nimport ExitToAppOutlinedIcon from '@material-ui/icons/ExitToAppOutlined';\nimport GroupAddOutlinedIcon from '@material-ui/icons/GroupAddOutlined';\nimport { Send } from \"@material-ui/icons\";\nimport ChatItem from \"./ChatItem\";\nimport VideoChat_test from \"./VideoChat_test\";\nconst Chat = require(\"twilio-chat\");\n\nclass ChatScreen extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      text: \"\",\n      messages: [],\n      loading: false,\n      channel: null,\n      isVideo: false,\n      channelList: [],\n      client: null,\n      email: this.props.email,\n      room: this.props.room,\n    };\n\n    this.scrollDiv = React.createRef();\n  };\n  getToken = async (email) => {\n    var data = await fetch(\"/chat/token\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        identity: email,\n      }),\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    }).then((res) => res.json());\n    return data.token;\n  };\n\n  componentDidMount = async () => {\n    document.getElementsByTagName('body')[0].style.background = \"rgb(255,255,255)\";\n    const { email, room } = this.state;\n    let token = \"\";\n\n    this.setState({ loading: true });\n\n    try {\n      token = await this.getToken(email);\n    } catch {\n      throw new Error(\"unable to get token, please reload thissss page\");\n    }\n    const client = await Chat.Client.create(token);\n    this.setState({client : client});\n\n    client.on(\"tokenAboutToExpire\", async () => {\n      const token = await this.getToken(email);\n      client.updateToken(token);\n    });\n\n    client.on(\"tokenExpired\", async () => {\n      const token = await this.getToken(email);\n      client.updateToken(token);\n    });\n\n    // client.on(\"channelJoined\", async (channel) => {\n    //   // getting list of all messages since this is an existing channel\n    //   const messages = await channel.getMessages();\n    //   this.setState({ messages: messages.items || [] });\n    //   //   this.scrollToBottom();\n    // });\n    try {\n      this.joine(room);\n    } catch {\n      try {\n        const channel = await client.createChannel({\n          uniqueName: room,\n          friendlyName: room,\n        });\n        await this.joinChannel(channel);\n        this.setState({ channel, loading: false });\n      } catch {\n        throw new Error(\"unable to create channel, please reload this page\");\n      }\n    }\n  };\n  joine = async (room)=>{\n    const {client} = this.state;\n    console.log(room);\n    const channel = await client.getChannelByUniqueName(room);\n    await this.joinChannel(channel);\n    this.setState({ channel, loading: false });\n    const messages = await channel.getMessages();\n    this.setState({ messages: messages.items || [] });\n    const channels = await client.getSubscribedChannels();\n    this.setState({channelList: channels.items || []});\n    }\n\n  joinChannel = async (channel) => {\n    if (channel.channelState.status !== \"joined\") {\n      await channel.join();\n    }\n    channel.on(\"messageAdded\", this.handleMessageAdded);\n  };\n\n  handleMessageAdded = (message) => {\n    const { messages } = this.state;\n    this.setState(\n      {\n        messages: !!messages ? [...messages, message] : [message],\n      },\n      //   this.scrollToBottom\n    );\n  };\n\n  //   scrollToBottom = () => {\n  //     const scrollHeight = this.scrollDiv.current.scrollHeight;\n  //     const height = this.scrollDiv.current.clientHeight;\n  //     const maxScrollTop = scrollHeight - height;\n  //     this.scrollDiv.current.scrollTop = maxScrollTop > 0 ? maxScrollTop : 0;\n  //   };\n\n  sendMessage = () => {\n    const { text, channel } = this.state;\n    if (text && String(text).trim()) {\n      this.setState({ loading: true });\n      channel && channel.sendMessage(text);\n      this.setState({ text: \"\", loading: false });\n    }\n  };\n\n  sendMessageExternal = (info) => {\n    const { channel } = this.state;\n    if (info && String(info).trim()) {\n      this.setState({ loading: true });\n      channel && channel.sendMessage(info);\n      this.setState({ loading: false });\n    }\n  }\n\n  setIsVideo = (val) => {\n    this.setState({ isVideo: val });\n  }\n\n  handleClick = () => {\n    this.setState({ isVideo: true });\n  }\n\n  switchChannel = (roomName)=>{\n    this.setState({room: roomName});\n    this.joine(roomName);\n  }\n  render() {\n    const { loading, text, messages, channel, isVideo, channelList, email, room} = this.state;\n    const { setSubmit } = this.props;\n    const channels = [];\n    for(let i = 0; i < channelList.length; i++){\n      channels.push(<Button style = {{display: \"block\"}} onClick = {()=>{this.switchChannel(channelList[i].friendlyName)}}>\n        <ListItem>\n          <ChevronRightIcon/>\n          {channelList[i].friendlyName}\n        </ListItem>\n      </Button>);\n    }\n    let component;\n    if (isVideo) {\n      component = <VideoChat_test username={email} roomName={room} messages={messages}\n        setIsVideo={this.setIsVideo} sendMessage={this.sendMessageExternal} />\n    } else {\n      component = <Container component=\"main\" maxWidth=\"md\" style = {{maxWidth:\"none\", paddingLeft: \"0px\", background:\"rgb(242, 243, 248)\"}}>\n        <Backdrop open={loading} style={{ zIndex: 99999 }}>\n          <CircularProgress style={{ color: \"white\" }} />\n        </Backdrop>\n        <AppBar elevation={10}>\n          <Toolbar style={{ justifyContent: 'space-between' }}>\n            <Typography variant=\"h6\">\n              YOUR ROOMS\n            </Typography>\n            <Grid container direction = \"column\">\n              <Grid item>\n                <Typography variant = 'h6'>\n                  ROOM\n                </Typography>\n              </Grid>\n            </Grid>\n            <Grid container direction=\"row-reverse\" style = {{width: \"84%\"}}>\n              <Grid item>\n                <Tooltip title=\"Leave\">\n                  <Button onClick = {() => {setSubmit()}}>\n                    <ExitToAppOutlinedIcon style={{ position: 'relative', fontSize: \"2.45rem\", color: \"white\", marginTop :'4px' }}></ExitToAppOutlinedIcon>\n                  </Button>\n                </Tooltip>\n              </Grid>\n              <Grid item>\n                <Tooltip title=\"Add others\">\n                  <Button >\n                    <GroupAddOutlinedIcon style={{ position: 'relative', fontSize: \"xxx-large\", color: \"white\" }}></GroupAddOutlinedIcon>\n                  </Button>\n                </Tooltip>\n              </Grid>\n              <Grid item>\n                <Tooltip title=\"Switch to Video call\">\n                  <Button onClick={this.handleClick}>\n                    <VideoCallOutlinedIcon style={{ position: 'relative', fontSize: \"xxx-large\", color: \"white\" }}></VideoCallOutlinedIcon>\n                  </Button>\n                </Tooltip>\n              </Grid>\n            </Grid>\n          </Toolbar>\n        </AppBar>\n        {/* <CssBaseline /> */}\n        <Grid container style = {{width : \"100%\"}}>\n          <Grid item style = {{width :\"18%\", background: \"rgb(242, 243, 248)\", marginRightght: \"15px\", height:\"100vh\"}}>\n            <List style = {{paddingTop: \"100px\"}}>\n              {channels}\n            </List>\n          </Grid>\n          <Grid item style = {{width: \"80%\", paddingRight:\"15px\"}}>\n          <Grid container direction=\"column\" style={styles.mainGrid}>\n          <Grid item style={styles.gridItemChatList} >\n            <List dense={true}>\n              {messages &&\n                messages.map((message) => (\n                  <ChatItem\n                    key={message.index}\n                    message={message}\n                    email={email}\n                  />\n                ))}\n            </List>\n          </Grid>\n          <Grid item style={styles.gridItemMessage}>\n            <Grid\n              container\n              direction=\"row\"\n              justify=\"center\"\n              alignItems=\"center\"\n            >\n              <Grid item style={styles.textFieldContainer}>\n                <TextField\n                  required\n                  style={styles.textField}\n                  placeholder=\"Send a message to everyone\"\n                  variant=\"outlined\"\n                  multiline\n                  rows={2}\n                  value={text}\n                  disabled={!channel}\n                  onChange={(event) =>\n                    this.setState({ text: event.target.value })\n                  }\n                />\n              </Grid>\n              <Grid item>\n                <IconButton\n                  style={styles.sendButton}\n                  onClick={this.sendMessage}\n                  disabled={!channel || !text}\n                >\n                  <Send style={styles.sendIcon} />\n                </IconButton>\n              </Grid>\n            </Grid>\n          </Grid>\n        </Grid>\n          </Grid>\n        </Grid>\n        \n      </Container>\n    }\n\n    return (\n      component\n    );\n  }\n}\n\nconst styles = {\n  textField: { width: \"100%\", borderWidth: 0, borderColor: \"transparent\" },\n  textFieldContainer: { flex: 1, marginRight: 12 },\n  gridItem: { paddingTop: 12, paddingBottom: 12 },\n  gridItemChatList: { overflow: \"auto\", height: \"70vh\" },\n  gridItemMessage: { marginTop: 12, marginBottom: 12 },\n  sendButton: { backgroundColor: \"#3f51b5\" },\n  sendIcon: { color: \"white\" },\n  mainGrid: { paddingTop: 100, borderWidth: 1 , background:\"white\", borderRadius:\"3px\", paddingRight: \"10px\", paddingLeft: \"10px\"},\n};\n\nexport default ChatScreen;\n"]},"metadata":{},"sourceType":"module"}