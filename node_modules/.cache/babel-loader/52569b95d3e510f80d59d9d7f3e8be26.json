{"ast":null,"code":"'use strict';\n/**\n * The {@link DocumentVisibilityMonitor} monitors the visibility state of the DOM\n * and executes the attached listeners in phase order when the DOM is visible.\n */\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nvar DocumentVisibilityMonitor = function () {\n  /**\n   * Constructor.\n   * @param {number} [nPhases=1] - the number of phases\n   */\n  function DocumentVisibilityMonitor() {\n    var _this = this;\n\n    var nPhases = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n\n    _classCallCheck(this, DocumentVisibilityMonitor);\n\n    Object.defineProperties(this, {\n      _listeners: {\n        value: []\n      },\n      _onVisibilityChange: {\n        value: function value() {\n          _this._emitVisible(document.visibilityState === 'visible');\n        }\n      }\n    });\n\n    for (var i = 0; i < nPhases; i++) {\n      this._listeners.push([]);\n    }\n  }\n  /**\n   * clears the state.\n   */\n\n\n  _createClass(DocumentVisibilityMonitor, [{\n    key: 'clear',\n    value: function clear() {\n      var nPhases = this._listeners.length;\n\n      for (var i = 0; i < nPhases; i++) {\n        this._listeners[i] = [];\n      }\n    }\n  }, {\n    key: '_listenerCount',\n    value: function _listenerCount() {\n      return this._listeners.reduce(function (count, phaseListeners) {\n        return count + phaseListeners.length;\n      }, 0);\n    }\n    /**\n     * Call all the listeners. Makes sure that all listeners for a given phase\n     * are executed before calling the listeners of the next phase.\n     * @private\n     */\n\n  }, {\n    key: '_emitVisible',\n    value: function _emitVisible(isVisible) {\n      var _this2 = this;\n\n      var promise = Promise.resolve();\n\n      var _loop = function _loop(phase) {\n        promise = promise.then(function () {\n          return _this2._emitVisiblePhase(phase, isVisible);\n        });\n      };\n\n      for (var phase = 1; phase <= this._listeners.length; phase++) {\n        _loop(phase);\n      }\n\n      return promise;\n    }\n    /**\n     * Call all the listeners for a given phase.\n     * @private\n     */\n\n  }, {\n    key: '_emitVisiblePhase',\n    value: function _emitVisiblePhase(phase, isVisible) {\n      var phaseListeners = this._listeners[phase - 1];\n      return Promise.all(phaseListeners.map(function (listener) {\n        var ret = listener(isVisible);\n        return ret instanceof Promise ? ret : Promise.resolve(ret);\n      }));\n    }\n    /**\n     * Start listening to the DOM visibility state change.\n     * @private\n     */\n\n  }, {\n    key: '_start',\n    value: function _start() {\n      document.addEventListener('visibilitychange', this._onVisibilityChange);\n    }\n    /**\n     * Stop listening to the DOM visibility state change.\n     * @private\n     */\n\n  }, {\n    key: '_stop',\n    value: function _stop() {\n      document.removeEventListener('visibilitychange', this._onVisibilityChange);\n    }\n    /**\n     * Listen for the DOM visibility changes at the given phase.\n     * @param {number} phase\n     * @param {function} listener\n     * @returns {this}\n     */\n\n  }, {\n    key: 'onVisibilityChange',\n    value: function onVisibilityChange(phase, listener) {\n      if (typeof phase !== 'number' || phase <= 0 || phase > this._listeners.length) {\n        throw new Error('invalid phase: ', phase);\n      }\n\n      var phaseListeners = this._listeners[phase - 1];\n      phaseListeners.push(listener);\n\n      if (this._listenerCount() === 1) {\n        this._start();\n      }\n\n      return this;\n    }\n    /**\n     * Stop listening for the DOM visibility change at the given phase.\n     * @param {number} phase\n     * @param {function} listener\n     * @returns {this}\n     */\n\n  }, {\n    key: 'offVisibilityChange',\n    value: function offVisibilityChange(phase, listener) {\n      if (typeof phase !== 'number' || phase <= 0 || phase > this._listeners.length) {\n        throw new Error('invalid phase: ', phase);\n      }\n\n      var phaseListeners = this._listeners[phase - 1];\n      var index = phaseListeners.indexOf(listener);\n\n      if (index !== -1) {\n        phaseListeners.splice(index, 1);\n\n        if (this._listenerCount() === 0) {\n          this._stop();\n        }\n      }\n\n      return this;\n    }\n  }]);\n\n  return DocumentVisibilityMonitor;\n}();\n\nmodule.exports = new DocumentVisibilityMonitor(2);","map":{"version":3,"sources":["/Users/shouryagupta/Desktop/MS Engage 21/MSEngage21_VC/node_modules/twilio-video/es5/util/documentvisibilitymonitor.js"],"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_classCallCheck","instance","TypeError","DocumentVisibilityMonitor","_this","nPhases","arguments","undefined","_listeners","value","_onVisibilityChange","_emitVisible","document","visibilityState","push","clear","_listenerCount","reduce","count","phaseListeners","isVisible","_this2","promise","Promise","resolve","_loop","phase","then","_emitVisiblePhase","all","map","listener","ret","_start","addEventListener","_stop","removeEventListener","onVisibilityChange","Error","offVisibilityChange","index","indexOf","splice","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\n/**\n * The {@link DocumentVisibilityMonitor} monitors the visibility state of the DOM\n * and executes the attached listeners in phase order when the DOM is visible.\n */\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DocumentVisibilityMonitor = function () {\n  /**\n   * Constructor.\n   * @param {number} [nPhases=1] - the number of phases\n   */\n  function DocumentVisibilityMonitor() {\n    var _this = this;\n\n    var nPhases = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n\n    _classCallCheck(this, DocumentVisibilityMonitor);\n\n    Object.defineProperties(this, {\n      _listeners: {\n        value: []\n      },\n      _onVisibilityChange: {\n        value: function value() {\n          _this._emitVisible(document.visibilityState === 'visible');\n        }\n      }\n    });\n\n    for (var i = 0; i < nPhases; i++) {\n      this._listeners.push([]);\n    }\n  }\n\n  /**\n   * clears the state.\n   */\n\n\n  _createClass(DocumentVisibilityMonitor, [{\n    key: 'clear',\n    value: function clear() {\n      var nPhases = this._listeners.length;\n      for (var i = 0; i < nPhases; i++) {\n        this._listeners[i] = [];\n      }\n    }\n  }, {\n    key: '_listenerCount',\n    value: function _listenerCount() {\n      return this._listeners.reduce(function (count, phaseListeners) {\n        return count + phaseListeners.length;\n      }, 0);\n    }\n\n    /**\n     * Call all the listeners. Makes sure that all listeners for a given phase\n     * are executed before calling the listeners of the next phase.\n     * @private\n     */\n\n  }, {\n    key: '_emitVisible',\n    value: function _emitVisible(isVisible) {\n      var _this2 = this;\n\n      var promise = Promise.resolve();\n\n      var _loop = function _loop(phase) {\n        promise = promise.then(function () {\n          return _this2._emitVisiblePhase(phase, isVisible);\n        });\n      };\n\n      for (var phase = 1; phase <= this._listeners.length; phase++) {\n        _loop(phase);\n      }\n      return promise;\n    }\n\n    /**\n     * Call all the listeners for a given phase.\n     * @private\n     */\n\n  }, {\n    key: '_emitVisiblePhase',\n    value: function _emitVisiblePhase(phase, isVisible) {\n      var phaseListeners = this._listeners[phase - 1];\n      return Promise.all(phaseListeners.map(function (listener) {\n        var ret = listener(isVisible);\n        return ret instanceof Promise ? ret : Promise.resolve(ret);\n      }));\n    }\n\n    /**\n     * Start listening to the DOM visibility state change.\n     * @private\n     */\n\n  }, {\n    key: '_start',\n    value: function _start() {\n      document.addEventListener('visibilitychange', this._onVisibilityChange);\n    }\n\n    /**\n     * Stop listening to the DOM visibility state change.\n     * @private\n     */\n\n  }, {\n    key: '_stop',\n    value: function _stop() {\n      document.removeEventListener('visibilitychange', this._onVisibilityChange);\n    }\n\n    /**\n     * Listen for the DOM visibility changes at the given phase.\n     * @param {number} phase\n     * @param {function} listener\n     * @returns {this}\n     */\n\n  }, {\n    key: 'onVisibilityChange',\n    value: function onVisibilityChange(phase, listener) {\n      if (typeof phase !== 'number' || phase <= 0 || phase > this._listeners.length) {\n        throw new Error('invalid phase: ', phase);\n      }\n      var phaseListeners = this._listeners[phase - 1];\n      phaseListeners.push(listener);\n      if (this._listenerCount() === 1) {\n        this._start();\n      }\n      return this;\n    }\n\n    /**\n     * Stop listening for the DOM visibility change at the given phase.\n     * @param {number} phase\n     * @param {function} listener\n     * @returns {this}\n     */\n\n  }, {\n    key: 'offVisibilityChange',\n    value: function offVisibilityChange(phase, listener) {\n      if (typeof phase !== 'number' || phase <= 0 || phase > this._listeners.length) {\n        throw new Error('invalid phase: ', phase);\n      }\n\n      var phaseListeners = this._listeners[phase - 1];\n      var index = phaseListeners.indexOf(listener);\n      if (index !== -1) {\n        phaseListeners.splice(index, 1);\n        if (this._listenerCount() === 0) {\n          this._stop();\n        }\n      }\n      return this;\n    }\n  }]);\n\n  return DocumentVisibilityMonitor;\n}();\n\nmodule.exports = new DocumentVisibilityMonitor(2);"]},"metadata":{},"sourceType":"script"}